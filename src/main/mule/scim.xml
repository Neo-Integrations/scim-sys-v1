<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core" xmlns="http://www.mulesoft.org/schema/mule/core"
	xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd">


    <sub-flow name="init-get-user-subflow" doc:id="8580e0f0-5bd2-4550-90fd-3fa8e1864efe">
		<set-variable value="#[attributes.queryParams.filter]" doc:name="Set filter" doc:id="9df02234-bf27-43a0-9819-a72e5469c553" variableName="filter" />
		<ee:transform doc:name="Transform Message" doc:id="678b84d3-165e-43a1-93d7-0e721a38005b">
			<ee:message>
			</ee:message>
			<ee:variables>
				<ee:set-variable variableName="userName"><![CDATA[%dw 2.0
output application/java

var filterNotNull = (attributes.queryParams.filter default "")
var emailAddress = if(sizeOf(filterNotNull splitBy("eq")) > 1) (filterNotNull splitBy("eq"))[1] else ""
---
trim(emailAddress replace '"' with "")]]></ee:set-variable>
			</ee:variables>
		</ee:transform>
		<set-variable value="#[if(attributes.queryParams.startIndex == null or attributes.queryParams.startIndex &lt;= 0) 1 else attributes.queryParams.startIndex]" doc:name="Set startIndex" doc:id="e31cda60-38a2-4f6f-93c8-cecf35968104" variableName="startIndex" />
		<set-variable value="#[(attributes.queryParams.count default 10)]" doc:name="Set Count" doc:id="bf31c7d8-bd4b-497f-874a-dd1163626ea1" variableName="count" />
		<set-variable value="#[(vars.startIndex - 1) * vars.count + 1]" doc:name="Set Variable" doc:id="63402499-9ffb-4b58-a080-00d8ecedcc47" variableName="offset"/>
	</sub-flow>
	
	
</mule>
